# 技术报告：基于小众辅助信息图的 RE-GCN 时序知识图谱补全增强方案

## 0. 报告目的与读者

**目的**：为研发同学提供可直接落地实现的技术方案，用于在现有 **RE-GCN（Recurrent Evolution GCN）** 框架上，引入三类小众但信息密度极高的辅助信息图，以显著提升时序知识图谱补全（TKGC）性能与可解释性。

**目标读者**：

- 从事 TKGC / 动态图表示学习的算法工程师
- 熟悉 PyTorch + DGL / PyG 的研发人员
- 已有 RE-GCN / R-GCN 实现基础的同学

---

## 1. 背景：RE-GCN 的建模边界

RE-GCN 的核心机制可以概括为：

1. 在每个时间片 $t$ 上，对事实图 $G_t$ 做 R-GCN 消息传递
2. 使用 GRU 对实体和关系表示进行时间递归更新
3. 假设时间演化是**平滑、连续、无显式约束的**

这带来了三个天然空缺：

- ❌ 无法显式感知 **演化断裂 / 突变**
- ❌ 无法区分 **相关性 vs 因果性** 的时间依赖
- ❌ 无法表达 **时间逻辑与排他性约束**

本报告围绕上述三个空缺，提出三种辅助信息图。

---

## 2. 方案一：时间一致性破坏图（Temporal Inconsistency Graph, TIG）

### 2.1 核心动机

主流 TKGC 方法默认假设：

> 相邻时间片中实体的结构与语义应保持高度一致

但在真实世界中：

- 政权更迭、破产重组、战争爆发等事件会导致 **实体关系结构突变**

**关键思想**：

> 将“演化不连续性”显式建模为图结构，并用于调制时间递归机制

---

### 2.2 图结构定义

#### 节点

- 实体时间实例：$e@t$

#### 边（破坏边 / Break Edge）

若实体 $e$ 在 $t-1$ 与 $t$ 之间发生显著结构变化，则连边：

$$ (e@t-1, e@t) \in \mathcal{E}^{break} $$

#### 结构变化度量（可选实现）

1. **邻居关系分布 KL 散度**
   $$ D_{KL}(P_{t-1}(r|e) || P_t(r|e)) $$

2. **关系集合 Jaccard 距离**
   $$ 1 - \frac{|R_{t-1}(e) \cap R_t(e)|}{|R_{t-1}(e) \cup R_t(e)|} $$

3. **度数突变率**
   $$ \frac{|deg_t(e) - deg_{t-1}(e)|}{deg_{t-1}(e)} $$

---

### 2.3 与 RE-GCN 的融合方式（关键）

TIG **不参与消息传播**，而是作为 **时间门控信号**。

在实体 GRU 更新中引入 break embedding $b_e^t$：

$$ z_t = \sigma(W_z m_t + U_z h_{t-1} + V_z b_e^t) $$

- 若存在 break edge：$b_e^t$ 强
- GRU 更倾向于 **遗忘历史状态**

---

### 2.4 工程实现建议

- TIG 预处理阶段离线构建
- break edge 仅用于生成 binary / scalar mask
- 不增加 GNN 计算复杂度

---

## 3. 方案二：时间因果依赖图（Temporal Causal Dependency Graph, TCDG）

### 3.1 核心动机

RE-GCN 的时间建模是序列相关建模，但：

- 无法区分因果与相关
- 所有历史信息被等价对待

**关键思想**：

> 显式建模“关系在时间上的因果触发链”

---

### 3.2 图结构定义

#### 节点

- 关系时间实例：$r@t$

#### 有向边（因果边）

若：
$$ P((e,r_j,*)@t+\Delta | (e,r_i,*)@t) \gg P((e,r_j,*)@t+\Delta) $$

则：
$$ r_i@t \rightarrow r_j@t+\Delta $$

---

### 3.3 构建方式（工程可行）

- 统计滑动时间窗内的条件共现频率
- 使用 PMI / conditional lift 作为因果强度
- 仅保留 Top-K 因果边

---

### 3.4 与 RE-GCN 的融合

在关系演化阶段，引入因果聚合：

$$ \tilde{h}_r^t = h_r^t + \sum_{(r_i,\Delta)} \alpha_{i,\Delta} h_{r_i}^{t-\Delta} $$

- $\alpha$ 来源于 TCDG
- 等价于因果先验注入

---

### 3.5 工程建议

- TCDG 是 DAG，可用轻量 MLP / attention 聚合
- 可只对高频关系启用

---

## 4. 方案三：时间约束图（Temporal Constraint Graph, TCG）

### 4.1 核心动机

TKG 中存在大量隐式时间逻辑约束：

- 排他性（同一时间只能一个）
- 顺序性（先发生 A 才能发生 B）

但现有方法几乎不在表示学习阶段建模。

---

### 4.2 图结构定义

#### 节点

- 事实实例：$(e,r,o)@t$

#### 约束边

1. **互斥约束**
   $$ (f_i, f_j) \in \mathcal{E}^{mutex} $$

2. **先后约束**
   $$ f_i@t \prec f_j@t' $$

---

### 4.3 融合方式（不是后处理）

定义约束损失：

$$ \mathcal{L}_{constraint} = \sum_{(f_i,f_j)} \max(0, \gamma - d(f_i,f_j)) $$

- 与 RE-GCN 主损失联合训练
- 直接影响 embedding 学习

---

### 4.4 工程建议

- 约束规则可由统计自动挖掘
- 只对高置信规则启用


